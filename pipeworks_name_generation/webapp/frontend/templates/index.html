<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pipeworks Name Generator</title>
    <link rel="stylesheet" href="/static/app.css" />
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="header-row">
        <h1>Pipeworks Name Generator</h1>
        <button type="button" id="theme-toggle" class="theme-toggle">Light Theme</button>
      </div>
      <div class="tabs">
        <button type="button" class="tab active" data-tab="generation">Generation</button>
        <button type="button" class="tab" data-tab="database">Database View</button>
        <button type="button" class="tab" data-tab="import">Import</button>
        <button type="button" class="tab" data-tab="favorites">Favorites</button>
        <button type="button" class="tab" data-tab="help">Help</button>
      </div>

      <section class="panel active" id="panel-generation">
        <article class="generation-card generation-placeholder generation-card-full-width">
          <h3>Generation Placeholder</h3>
          <p class="muted">Reserved for future blended generation controls.</p>
        </article>

        <section class="generation-class-wrapper generation-card-full-width">
          <div class="row-buttons">
            <button type="button" id="generation-toggle-btn">Show Name Class Cards</button>
            <span id="generation-toggle-status" class="muted">Cards collapsed to save vertical space.</span>
          </div>
          <div id="generation-class-card-section" class="generation-class-grid generation-class-grid-collapsed">
            <article class="generation-card generation-class-card" data-class-key="first_name">
              <h3>First Name</h3>
              <select id="generation-package-first_name" class="generation-package-select"></select>
              <select id="generation-syllables-first_name" class="generation-syllable-select"></select>
              <button type="button" id="generation-send-first_name" class="generation-send-btn">
                Send to API Builder
              </button>
              <p id="generation-note-first_name" class="muted">Loading package options...</p>
            </article>

            <article class="generation-card generation-class-card" data-class-key="last_name">
              <h3>Last Name</h3>
              <select id="generation-package-last_name" class="generation-package-select"></select>
              <select id="generation-syllables-last_name" class="generation-syllable-select"></select>
              <button type="button" id="generation-send-last_name" class="generation-send-btn">
                Send to API Builder
              </button>
              <p id="generation-note-last_name" class="muted">Loading package options...</p>
            </article>

            <article class="generation-card generation-class-card" data-class-key="place_name">
              <h3>Place Name</h3>
              <select id="generation-package-place_name" class="generation-package-select"></select>
              <select id="generation-syllables-place_name" class="generation-syllable-select"></select>
              <button type="button" id="generation-send-place_name" class="generation-send-btn">
                Send to API Builder
              </button>
              <p id="generation-note-place_name" class="muted">Loading package options...</p>
            </article>

            <article class="generation-card generation-class-card" data-class-key="location_name">
              <h3>Location Name</h3>
              <select id="generation-package-location_name" class="generation-package-select"></select>
              <select id="generation-syllables-location_name" class="generation-syllable-select"></select>
              <button type="button" id="generation-send-location_name" class="generation-send-btn">
                Send to API Builder
              </button>
              <p id="generation-note-location_name" class="muted">Loading package options...</p>
            </article>

            <article class="generation-card generation-class-card" data-class-key="object_item">
              <h3>Object Item</h3>
              <select id="generation-package-object_item" class="generation-package-select"></select>
              <select id="generation-syllables-object_item" class="generation-syllable-select"></select>
              <button type="button" id="generation-send-object_item" class="generation-send-btn">
                Send to API Builder
              </button>
              <p id="generation-note-object_item" class="muted">Loading package options...</p>
            </article>

            <article class="generation-card generation-class-card" data-class-key="organisation">
              <h3>Organisation</h3>
              <select id="generation-package-organisation" class="generation-package-select"></select>
              <select id="generation-syllables-organisation" class="generation-syllable-select"></select>
              <button type="button" id="generation-send-organisation" class="generation-send-btn">
                Send to API Builder
              </button>
              <p id="generation-note-organisation" class="muted">Loading package options...</p>
            </article>

            <article class="generation-card generation-class-card" data-class-key="title_epithet">
              <h3>Title Epithet</h3>
              <select id="generation-package-title_epithet" class="generation-package-select"></select>
              <select id="generation-syllables-title_epithet" class="generation-syllable-select"></select>
              <button type="button" id="generation-send-title_epithet" class="generation-send-btn">
                Send to API Builder
              </button>
              <p id="generation-note-title_epithet" class="muted">Loading package options...</p>
            </article>
          </div>
        </section>

        <article class="generation-card generation-placeholder generation-card-full-width">
          <h3>API Builder</h3>
          <div class="api-builder-layout">
            <section class="api-builder-left-column">
              <section class="api-builder-pane api-builder-selection-pane">
                <h4>Selected Inputs</h4>
                <ul id="api-builder-queue"></ul>
                <div class="row-buttons">
                  <button type="button" id="api-builder-clear-btn">Clear Builder</button>
                </div>
                <p id="api-builder-combined">Combined unique combinations: 0</p>
              </section>
              <section class="api-builder-pane">
                <h4>Request Parameters</h4>
                <div class="api-builder-param-grid">
                  <label for="api-builder-param-count">Number of Generations</label>
                  <input
                    id="api-builder-param-count"
                    type="number"
                    min="1"
                    max="100000"
                    value="100"
                  />
                </div>
                <div class="api-builder-param-grid">
                  <label for="api-builder-param-seed">Seed (optional)</label>
                  <input id="api-builder-param-seed" type="number" placeholder="blank = random" />
                </div>
                <div class="api-builder-param-grid">
                  <label for="api-builder-param-format">Output Format</label>
                  <select id="api-builder-param-format">
                    <option value="json">json</option>
                    <option value="txt">txt</option>
                  </select>
                </div>
                <div class="api-builder-checkbox-row">
                  <input id="api-builder-param-unique" type="checkbox" />
                  <label for="api-builder-param-unique">Unique only</label>
                  <span class="api-builder-render-label">Render</span>
                  <div class="api-builder-render-options" role="group" aria-label="Render style">
                    <label for="api-builder-render-raw" class="api-builder-render-option">
                      <input
                        id="api-builder-render-raw"
                        class="api-builder-render-option-input"
                        type="checkbox"
                        data-render-style="raw"
                        checked
                      />
                      Raw
                    </label>
                    <label for="api-builder-render-lower" class="api-builder-render-option">
                      <input
                        id="api-builder-render-lower"
                        class="api-builder-render-option-input"
                        type="checkbox"
                        data-render-style="lower"
                      />
                      lower
                    </label>
                    <label for="api-builder-render-upper" class="api-builder-render-option">
                      <input
                        id="api-builder-render-upper"
                        class="api-builder-render-option-input"
                        type="checkbox"
                        data-render-style="upper"
                      />
                      UPPER
                    </label>
                    <label for="api-builder-render-title" class="api-builder-render-option">
                      <input
                        id="api-builder-render-title"
                        class="api-builder-render-option-input"
                        type="checkbox"
                        data-render-style="title"
                      />
                      Title
                    </label>
                    <label for="api-builder-render-sentence" class="api-builder-render-option">
                      <input
                        id="api-builder-render-sentence"
                        class="api-builder-render-option-input"
                        type="checkbox"
                        data-render-style="sentence"
                      />
                      Sentence
                    </label>
                  </div>
                </div>
                <div class="api-builder-checkbox-row api-builder-preview-cap-row">
                  <input id="api-builder-preview-cap-enabled" type="checkbox" checked />
                  <label for="api-builder-preview-cap-enabled">Cap preview at 20</label>
                </div>
                <button type="button" id="api-builder-generate-preview-btn">Generate Preview</button>
                <p id="api-builder-param-summary">
                  Set request defaults used by the query/payload preview.
                </p>
                <p id="api-builder-preview-cap" class="muted api-builder-preview-note">
                  Preview shows up to 20 names per selection. Combinations are built from previewed names.
                </p>
                <div class="api-builder-inline-preview-grid">
                  <section class="api-builder-inline-preview-card">
                    <div class="api-builder-preview-header">
                      <h5>Generated Names Preview</h5>
                      <div class="api-builder-preview-actions">
                        <button
                          type="button"
                          id="api-builder-inline-fav-btn"
                          class="api-builder-preview-copy-btn"
                          title="Favorite all generated names"
                        >
                          <span class="favorite-icon" aria-hidden="true"></span>
                          <span>Favorite All</span>
                        </button>
                        <button
                          type="button"
                          id="api-builder-inline-copy-btn"
                          class="api-builder-preview-copy-btn"
                          title="Copy generated names"
                        >
                          <span class="builder-preview-copy-icon" aria-hidden="true"></span>
                          <span>Copy</span>
                        </button>
                        <button
                          type="button"
                          id="api-builder-inline-export-btn"
                          class="api-builder-preview-copy-btn"
                          title="Export generated names as a .txt file"
                        >
                          <span class="builder-preview-copy-icon" aria-hidden="true"></span>
                          <span>Export TXT</span>
                        </button>
                      </div>
                    </div>
                    <div id="api-builder-inline-preview" class="api-builder-preview-list muted">
                      No preview generated yet.
                    </div>
                  </section>
                  <section class="api-builder-inline-preview-card">
                    <div class="api-builder-preview-header">
                      <h5>First + Last Combinations</h5>
                      <div class="api-builder-preview-actions">
                        <button
                          type="button"
                          id="api-builder-combo-fav-btn"
                          class="api-builder-preview-copy-btn"
                          title="Favorite all combinations"
                        >
                          <span class="favorite-icon" aria-hidden="true"></span>
                          <span>Favorite All</span>
                        </button>
                        <button
                          type="button"
                          id="api-builder-combo-copy-btn"
                          class="api-builder-preview-copy-btn"
                          title="Copy combinations"
                        >
                          <span class="builder-preview-copy-icon" aria-hidden="true"></span>
                          <span>Copy</span>
                        </button>
                        <button
                          type="button"
                          id="api-builder-combo-export-btn"
                          class="api-builder-preview-copy-btn"
                          title="Export combinations as a .txt file"
                        >
                          <span class="builder-preview-copy-icon" aria-hidden="true"></span>
                          <span>Export TXT</span>
                        </button>
                      </div>
                    </div>
                    <div id="api-builder-combo-preview" class="api-builder-preview-list muted">
                      No combination preview generated yet.
                    </div>
                  </section>
                </div>
                <hr class="section-divider" />
                <section class="api-builder-live-preview">
                  <div class="api-builder-live-header">
                    <div>
                      <h5>Live Preview</h5>
                      <p class="muted">Click a name above to focus it here.</p>
                    </div>
                    <button
                      type="button"
                      id="api-builder-live-fav-btn"
                      class="api-builder-preview-copy-btn"
                    >
                      <span class="favorite-icon" aria-hidden="true"></span>
                      <span>Favorite</span>
                    </button>
                  </div>
                  <div class="api-builder-live-controls">
                    <div class="api-builder-live-control">
                      <label for="preview-font-family">Font</label>
                      <select id="preview-font-family">
                        <option value="Crimson Text" data-fallback="serif">Crimson Text</option>
                        <option value="Libre Baskerville" data-fallback="serif">Libre Baskerville</option>
                        <option value="IM Fell English" data-fallback="serif">IM Fell English</option>
                        <option value="IM Fell English SC" data-fallback="serif">IM Fell English SC</option>
                        <option value="Special Elite" data-fallback="serif">Special Elite</option>
                        <option value="Courier Prime" data-fallback="monospace">Courier Prime</option>
                      </select>
                    </div>
                    <div class="api-builder-live-control">
                      <label for="preview-font-size">Size</label>
                      <div class="api-builder-live-range">
                        <input id="preview-font-size" type="range" min="12" max="42" value="22" />
                        <span id="preview-font-size-value">22px</span>
                      </div>
                    </div>
                    <div class="api-builder-live-control">
                      <label for="preview-font-weight">Weight</label>
                      <div class="api-builder-live-range">
                        <input id="preview-font-weight" type="range" min="300" max="900" step="100" value="500" />
                        <span id="preview-font-weight-value">500</span>
                      </div>
                    </div>
                    <div class="api-builder-live-control api-builder-live-checkbox">
                      <label>
                        <input id="preview-font-italic" type="checkbox" />
                        Italic
                      </label>
                    </div>
                  </div>
                  <div id="api-builder-live-output" class="api-builder-live-output muted">
                    No selection focused yet.
                  </div>
                </section>
              </section>
            </section>
            <section class="api-builder-pane api-builder-params-pane">
              <h4>Builder Preview</h4>
              <div class="builder-preview-controls">
                <div class="builder-preview-view-group">
                  <span class="builder-preview-label">Preview view</span>
                  <button type="button" id="api-builder-view-query-btn" class="builder-preview-view-btn">
                    View Query Text
                  </button>
                  <button type="button" id="api-builder-view-curl-btn" class="builder-preview-view-btn">
                    View cURL Set
                  </button>
                  <button type="button" id="api-builder-view-post-btn" class="builder-preview-view-btn">
                    View POST Set
                  </button>
                </div>
                <div class="builder-preview-status">
                  <span class="builder-preview-label">Status</span>
                  <p id="api-builder-copy-status">No query content yet.</p>
                </div>
              </div>
              <div class="builder-preview-output">
                <div class="builder-preview-header">
                  <span id="api-builder-preview-title">Query Text</span>
                  <button type="button" id="api-builder-copy-btn" class="builder-preview-copy-btn">
                    <span class="builder-preview-copy-icon" aria-hidden="true"></span>
                    <span>Copy</span>
                  </button>
                </div>
                <p id="api-builder-preview">No selections queued yet.</p>
              </div>
            </section>
          </div>
        </article>
        <p id="generation-status" class="muted">Loading package options...</p>
      </section>

      <section class="panel" id="panel-database">
        <div class="db-layout">
          <div class="db-sidebar">
            <section class="db-card">
              <h3>Tools</h3>
              <div class="row-buttons">
                <button type="button" id="db-refresh-packages">Refresh Packages</button>
                <button type="button" id="db-export-btn">Export DB</button>
                <button type="button" id="db-backup-btn">Write Backup</button>
              </div>
              <p class="muted">
                Export and backup paths are configured in <code>server.ini</code>.
              </p>
              <p id="db-export-status" class="muted">Ready for export or backup.</p>
            </section>

            <section class="db-card">
              <h3>Selection</h3>
              <div class="grid">
                <label for="db-package-select">Package</label>
                <select id="db-package-select"></select>
              </div>
              <div class="grid">
                <label for="db-table-select">Table</label>
                <select id="db-table-select"></select>
              </div>
              <p class="muted" id="db-status">Load packages to begin browsing.</p>
              <ul id="db-table-list"></ul>
            </section>
          </div>
          <div class="db-main">
            <div class="row-buttons">
              <button type="button" id="db-prev-btn">Previous</button>
              <button type="button" id="db-next-btn">Next</button>
              <span id="db-page-status" class="muted">Rows 0-0</span>
            </div>
            <table>
              <thead>
                <tr>
                  <th>Line</th>
                  <th>Value</th>
                </tr>
              </thead>
              <tbody id="db-row-body"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section class="panel" id="panel-import">
        <div class="grid">
          <label for="metadata-path">Metadata JSON Path</label>
          <input id="metadata-path" type="text" placeholder="/path/to/package_metadata.json" />
        </div>
        <div class="grid">
          <label for="zip-path">Package ZIP Path</label>
          <input id="zip-path" type="text" placeholder="/path/to/package.zip" />
        </div>
        <div class="row-buttons">
          <button type="button" id="import-btn">Import Pair</button>
        </div>
        <p id="import-status" class="muted">Waiting for input.</p>
      </section>

      <section class="panel" id="panel-favorites">
        <div class="favorites-layout">
          <div class="favorites-sidebar">
            <section class="favorites-card">
              <h3>Export & Backup</h3>
              <div class="row-buttons">
                <button type="button" id="favorites-refresh-btn">Refresh Favorites</button>
                <button type="button" id="favorites-export-btn">Export JSON</button>
              </div>
              <div class="grid favorites-path-grid">
                <label for="favorites-export-path">Backup Path</label>
                <input id="favorites-export-path" type="text" placeholder="/path/to/favorites_backup.json" />
              </div>
              <div class="row-buttons">
                <button type="button" id="favorites-backup-btn">Write Backup</button>
              </div>
            </section>

            <section class="favorites-card">
              <h3>Import</h3>
              <div class="grid favorites-path-grid">
                <label for="favorites-import-path">Import JSON Path</label>
                <input id="favorites-import-path" type="text" placeholder="/path/to/favorites_export.json" />
              </div>
              <div class="row-buttons">
                <button type="button" id="favorites-import-btn">Import Favorites</button>
              </div>
            </section>

            <section class="favorites-card">
              <h3>Filters</h3>
              <div class="grid">
                <label for="favorites-search">Search</label>
                <input id="favorites-search" type="text" placeholder="Search names or notes" />
              </div>
              <div class="grid">
                <label for="favorites-tag-filter">Tag</label>
                <select id="favorites-tag-filter"></select>
              </div>
            </section>
          </div>

          <div class="favorites-main">
            <p id="favorites-status" class="muted">Load favorites to begin browsing.</p>

            <div class="favorites-table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Class</th>
                    <th>Gender</th>
                    <th>Package</th>
                    <th>Tags</th>
                    <th>Note</th>
                    <th>Added</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="favorites-table-body"></tbody>
              </table>
            </div>

            <div class="row-buttons favorites-pagination">
              <button type="button" id="favorites-prev-btn">Previous</button>
              <button type="button" id="favorites-next-btn">Next</button>
              <span id="favorites-page-status" class="muted">Rows 0-0</span>
            </div>
          </div>
        </div>
      </section>

      <section class="panel" id="panel-help">
        <h2>Help</h2>
        <p class="muted" id="help-status">Loading help content...</p>
        <div id="help-content" class="help-content"></div>
      </section>
    </div>
  </div>

  <div id="favorites-modal" class="modal hidden" aria-hidden="true">
    <div class="modal-backdrop" data-close="true"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="favorites-modal-title">
      <div class="modal-header">
        <h3 id="favorites-modal-title">Save Favorites</h3>
        <button type="button" id="favorites-modal-close" class="icon-btn" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <p id="favorites-modal-summary" class="muted">No selections queued.</p>
      <div id="favorites-modal-names" class="favorites-modal-names"></div>
      <div class="grid">
        <label for="favorites-modal-gender">Gender (optional)</label>
        <select id="favorites-modal-gender">
          <option value="">Unspecified</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
      </div>
      <div class="grid">
        <label for="favorites-modal-tags">Tags (comma-separated)</label>
        <input id="favorites-modal-tags" type="text" placeholder="goblin, latin, flora" />
      </div>
      <div class="grid">
        <label for="favorites-modal-note">Note (Markdown)</label>
        <textarea id="favorites-modal-note" rows="4" placeholder="Optional notes..."></textarea>
      </div>
      <div class="row-buttons modal-actions">
        <button type="button" id="favorites-modal-cancel">Cancel</button>
        <button type="button" id="favorites-modal-save">Save Favorites</button>
      </div>
      <input id="favorites-modal-id" type="hidden" />
    </div>
  </div>

    <script src="/static/app.js"></script>
    <script src="/static/api_builder_preview.js"></script>
    <script src="/static/favorites.js"></script>
</body>
</html>
